(function(t){function e(e){for(var r,n,l=e[0],o=e[1],c=e[2],h=0,u=[];h<l.length;h++)n=l[h],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);d&&d(e);while(u.length)u.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],r=!0,l=1;l<s.length;l++){var o=s[l];0!==i[o]&&(r=!1)}r&&(a.splice(e--,1),t=n(n.s=s[0]))}return t}var r={},i={app:0},a=[];function n(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=r,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var d=o;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0786":function(t,e,s){},"0a65":function(t,e,s){"use strict";var r=s("2d9a"),i=s.n(r);i.a},"2d9a":function(t,e,s){},"309f":function(t,e){t.exports="data:image/png;base64,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"},"3f69":function(t,e,s){},"40d7":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);var r=s("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app"},[s("router-view"),s("audio",{ref:"myAudio",staticStyle:{display:"none"},attrs:{src:t.currentSongInfo?t.currentSongInfo.audio:""}}),s("div",{ref:"box",staticClass:"box"},[s("div",{staticClass:"boxLeft"},[s("img",{attrs:{src:t.currentSongInfo?t.currentSongInfo.img:"http://suzhengyao888.com:3000/images/timg.gif"}}),s("span",{staticClass:"noSong"},[t._v(t._s(t.currentSongInfo?t.currentSongInfo.title+"-"+t.currentSongInfo.author:"纵享音乐,让生活充满品质"))])]),s("div",{staticClass:"boxRight"},[s("div",{ref:"play0",class:t.playState?1===t.playState?"play start":"play pause":"play playNo"}),s("div",{ref:"list",class:t.playState?"list listCan":"list listNo"})])]),s("div",{ref:"songBox",class:t.enterOrLeave?"songBox songEnter":"songBox songLeave"},[s("img",{attrs:{src:t.currentSongInfo?t.currentSongInfo.img:""}}),s("div",{staticClass:"songInfo"},[s("div",{staticClass:"top"},[s("div",{ref:"back",staticClass:"back"}),s("div",{staticClass:"middle"},[s("span",{class:t.realIndex?"":"topActive"},[t._v("歌曲")]),s("div",{staticClass:"fen"}),s("span",{class:t.realIndex?"topActive":""},[t._v("歌词")])]),s("div")]),s("div",{staticClass:"swiper-song"},[s("div",{staticClass:"swiper-wrapper"},[s("div",{staticClass:"swiper-slide"},[s("div",{staticClass:"song"},[s("img",{attrs:{src:t.currentSongInfo?t.currentSongInfo.img:""}}),s("h2",[t._v(t._s(t.currentSongInfo?t.currentSongInfo.title:""))]),s("div",[t._v(t._s(t.currentSongInfo?t.currentSongInfo.author:""))]),s("div",{staticClass:"sentence"},[t._v(t._s(t.currentLyric.length?t.currentLyric[t.rowIndex].sentence.sentence:""))]),s("div",{staticClass:"controlWrap"},[s("div",{staticClass:"progressWrap"},[t._m(0),s("div",{staticClass:"progressTime"},[s("span",[t._v(t._s(t.formatTime(t.currentTime)))]),s("span",[t._v(t._s(t.formatTime(t.duration)))])])]),s("div",{staticClass:"control"},[s("div",{staticClass:"order"}),s("div",{ref:"pre",staticClass:"pre"}),s("div",{ref:"play1",class:1===t.playState?"playC":"pauseC"}),s("div",{ref:"next",staticClass:"next"}),s("div",{ref:"list0",staticClass:"controlList"})])])])]),s("div",{staticClass:"swiper-slide"},[s("div",{staticClass:"lyric"},[s("div",{staticClass:"title"},[t._v(t._s(t.currentSongInfo?t.currentSongInfo.title:""))]),s("div",[t._v(t._s(t.currentSongInfo?t.currentSongInfo.author:""))]),s("div",{ref:"lyricContent",staticClass:"lyricContent"},[s("div",{staticClass:"swiper-lyric"},[s("div",{staticClass:"swiper-wrapper"},t._l(t.currentLyric,(function(e,r){return s("div",{key:r,staticClass:"swiper-slide"},[t.rowIndex==r?s("div",{staticClass:"wrap"},t._l(e.words,(function(e,r){return s("div",{key:r,ref:"word",refInFor:!0,staticClass:"word"},[s("div",{staticClass:"wordLeft",domProps:{textContent:t._s(e.content)}}),s("div",{staticClass:"wordRight",domProps:{textContent:t._s(e.content)}})])})),0):s("span",[t._v(t._s(e.sentence.sentence))])])})),0)])]),s("div",{ref:"play2",class:"bottomPlay "+(1===t.playState?"":"bottomPause")})])])])])])]),s("div",{ref:"listBox",staticClass:"listBox"},[s("div",{ref:"localList",staticClass:"localList"},[s("div",{staticClass:"listHead"},[t._v("播放歌曲列表("+t._s(t.localSongList.length)+")条")]),s("Scroll",{attrs:{parentEle:!0,contentStyle:t.scrollStyle}},[s("ul",{ref:"ulist"},t._l(t.localSongList,(function(e,r){return s("li",{key:r,class:t.localIndex==r?"songListActive":"",attrs:{id:e._id,"data-index":r}},[t._v(" "+t._s(e.name)+" "),s("span",{staticClass:"listAuthor"},[t._v(t._s(e.author))])])})),0)]),s("div",{staticClass:"listClose"},[t._v("关闭")])],1)])],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"progressBar"},[s("div",{staticClass:"progressOuter"},[s("div",{staticClass:"controlDot"}),s("div",{staticClass:"progressInner"})])])}],n=s("b619"),l=s("2f62"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"ScrollContent",staticClass:"content",style:t.contentStyle},[t._t("default")],2)},c=[],d={props:["contentStyle","parentEle"],data(){return{translateY:0,timer:null}},methods:{QuadEaseOut(t,e,s,r){return-s*(t/=r)*(t-2)+e},addEvent(){let[t,e,s,r,i,a,n]=[null,null,null,null,null,null],l=this.$refs.ScrollContent;l.addEventListener("touchstart",o=>{o=o||window.event;let c=Number.parseFloat(l.offsetHeight),d=null;this.parentEle?(d=l.parentNode.offsetHeight,l.parentNode.style.overflow="hidden"):d=window.innerHeight,n=c-d,n<=0||(t=o.changedTouches[0].clientX,e=o.changedTouches[0].clientY,s=!0,i=!1,a=0,r=(new Date).getTime(),clearInterval(this.timer))}),l.addEventListener("touchmove",o=>{if(o=o||window.event,i||n<=0)return;let c=o.changedTouches[0].clientY,d=c-e;if(s){s=!1;let e=o.changedTouches[0].clientX,r=Math.abs(e-t),a=Math.abs(d);if(r>a)return void(i=!0)}let h=(new Date).getTime(),u=h-r;return a=d/u,this.translateY+=d,this.translateY>=0?(this.translateY=0,void(l.style.transform="translateY("+this.translateY+"px)")):Math.abs(this.translateY)>=n?(this.translateY=-n,void(l.style.transform="translateY("+this.translateY+"px)")):(l.style.transform="translateY("+this.translateY+"px)",e=c,void(r=h))}),l.addEventListener("touchend",()=>{if(!(n<=0)&&Math.abs(a)>.5){let t=200*a,e=this.translateY,s=1,r=Math.abs(Math.ceil(30*a));clearInterval(this.timer),this.timer=setInterval(()=>{s>r&&clearInterval(this.timer),this.translateY=this.QuadEaseOut(s,e,t,r),l.style.transform="translateY("+this.translateY+"px)",s++,this.translateY>=0&&(this.translateY=0,l.style.transform="translateY("+this.translateY+"px)",clearInterval(this.timer)),Math.abs(this.translateY)>=n&&(this.translateY=-n,l.style.transform="translateY("+this.translateY+"px)",clearInterval(this.timer))},1e3/60)}})}},mounted(){this.addEvent()}},h=d,u=(s("0a65"),s("2877")),g=Object(u["a"])(h,o,c,!1,null,"56e4c29c",null),p=g.exports,m={data(){return{translateY:0,enterOrLeave:!1,realIndex:0,playState:0,startState:!1,rowIndex:0,timer:null,sentenceTimer:null,isFirst:!0,wordTimer:[],localSongList:[],localIndex:0,duration:0,currentTime:0,changeCurrent:!1,canPlay:!1,moveProgress:!1,scrollStyle:{paddingBottom:".9rem",paddingTop:"1rem"}}},methods:{moveBoxTo(t){if(t===this.translateY)return;let e=(t-this.translateY)/15,s=setInterval(()=>{this.translateY+=e,(e>0&&this.translateY>=t||e<0&&this.translateY<=t)&&(this.translateY=t,clearInterval(s)),this.$refs.box.style.transform="translateY("+this.translateY+"rem)"},1e3/60)},songBoxInit(){let t=this;this.$mySwiperSongBox=new n["a"](".swiper-song",{on:{slideChange(){t.realIndex=this.realIndex}}})},lyricInit(){let t=parseInt(this.getStyle(this.$refs.lyricContent,"height"))/2;this.$myLyric=new n["a"](".swiper-lyric",{direction:"vertical",slidesPerView:"auto",slidesOffsetAfter:t,freeMode:!0,freeModeMinimumVelocity:1})},wordScroll(t,e){for(let r of this.wordTimer)clearInterval(r);this.wordTimer=[],t.currentIndex=0;let s=this.currentLyric[e].words;clearInterval(this.sentenceTimer),this.sentenceTimer=setInterval(()=>{let e=1e3*this.$refs.myAudio.currentTime;if(this.startState){this.startState=!1;for(let r=0;r<s.length;r++)s[r].start<=e&&(t.currentIndex=r);for(let e=0;e<t.currentIndex;e++){let s=t[e];if(s){let t=parseFloat(this.getStyle(s,"width"));s.firstElementChild.style.width=t+"px",s.lastElementChild.style.width="0px"}}}let r=s[t.currentIndex].start;if(e>=r){let e=t[t.currentIndex],r=e.firstElementChild,i=e.lastElementChild,a=parseFloat(this.getStyle(e,"width")),n=s[t.currentIndex].continued,l=t.currentIndex;clearInterval(this.wordTimer[l]),this.wordTimer[l]=setInterval(()=>{let e=parseFloat(this.getStyle(r,"width")),s=parseFloat(this.getStyle(i,"width"));if(e+1>=a||l+1<t.currentIndex)return r.style.width=a+"px",i.style.width="0px",void clearInterval(this.wordTimer[l]);r.style.width=e+1+"px",i.style.width=s-1+"px"},n/a),t.currentIndex++,t.currentIndex>=t.length&&clearInterval(this.sentenceTimer)}})},lyricControl(t){let e=this.$refs.myAudio.currentTime,{duration:s}=this;if(this.changeCurrent&&(this.changeCurrent=!1),this.moveProgress||(this.controlProgressBar(),this.currentTime=e),e>=s)return clearInterval(this.timer),void this.playNext();if(t&&this.$nextTick(()=>{this.wordScroll(this.$refs.word,0)}),this.startState&&!this.changeCurrent&&this.wordScroll(this.$refs.word,this.rowIndex),!this.currentLyric[this.rowIndex])return;let r=this.currentLyric[this.rowIndex].sentence.end;if(1e3*e>=r&&this.currentLyric[this.rowIndex+1]){this.rowIndex=this.rowIndex+1;let t=this.rowIndex>3?this.rowIndex-3:0;this.$myLyric.slideTo(t,300),this.$nextTick(()=>{this.wordScroll(this.$refs.word,this.rowIndex)})}},play(t){this.isFirst&&(this.isFirst=!1,t=!0),this.$refs.myAudio.play(),this.playState=2,clearInterval(this.timer),this.lyricControl(t),this.timer=setInterval(this.lyricControl,100)},pause(){clearInterval(this.timer),this.$refs.myAudio.pause(),this.playState=1,this.startState=!0,clearInterval(this.timer),clearInterval(this.sentenceTimer),clearInterval(this.wordTimer[this.wordTimer.length-1])},playNext(){let t=JSON.parse(window.localStorage.getItem("songList")),e=t.length,s=Number.parseInt(Math.random()*e);this.localIndex=s,window.localStorage.setItem("currentIndex",s);let r=t[s]._id;if(r===this.$store.state.current)return this.rowIndex=0,this.play(!0),void this.$myLyric.slideTo(0,0);this.$store.dispatch("changeCurrentA",r)},formatTime(t){t=Math.round(t);let e=Number.parseInt(t/60)>=10?""+Number.parseInt(t/60):"0"+Number.parseInt(t/60),s=Number.parseInt(t%60)>=10?""+Number.parseInt(t%60):"0"+Number.parseInt(t%60);return e+":"+s},controlProgressBar(){let{progressInner:t,controlDot:e,progressBarWidth:s,currentTime:r,duration:i}=this,a=r/i*s;t.style.width=a+"px",e.style.transform="translateX("+a+"px)"},changeProgressBar(){let{progressOuter:t,progressInner:e,controlDot:s,progressBarWidth:r}=this,i=t.getBoundingClientRect().left;t.addEventListener("touchmove",t=>{t=t||window.event,this.moveProgress=!0,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;let a=t.changedTouches[0].clientX,n=a-i<=0?0:a-i;n=n>=r?r:n,e.style.width=n+"px",s.style.transform="translateX("+n+"px)",this.currentTime=n/r*this.duration}),t.addEventListener("touchend",t=>{t=t||window.event;let a=t.changedTouches[0].clientX,n=a-i<=0?0:a-i;n=n>=r?r:n,e.style.width=n+"px",s.style.transform="translateX("+n+"px)",this.currentTime=n/r*this.duration;let{currentLyric:l,currentTime:o}=this,c=1e3*o;if(c<l[0].start)this.rowIndex=0;else if(c>=l[l.length-1].sentence.start)this.rowIndex=l.length-1;else for(let e=0;e<l.length;e++)if(c>=l[e].sentence.start&&c<l[e+1].sentence.start){this.rowIndex=e;break}let d=this.rowIndex>3?this.rowIndex-3:0;this.$myLyric.slideTo(d,300),this.$refs.myAudio.currentTime=this.currentTime,this.wordScroll(this.$refs.word,this.rowIndex),this.changeCurrent=!0,this.moveProgress=!1})}},mounted(){this.progressOuter=document.querySelector(".progressOuter"),this.progressInner=document.querySelector(".progressInner"),this.controlDot=document.querySelector(".controlDot");let t=this.progressOuter.offsetWidth,e=this.controlDot.offsetWidth;this.progressBarWidth=t-e,this.changeProgressBar(),"/"!=this.$route.path&&(this.translateY=1,this.$refs.box.style.transform="translateY("+this.translateY+"rem)"),this.current&&(this.playState=1,this.$api.songInfo({_id:this.current}).then(t=>{let e=t.data;this.$store.commit("initListM",{data:e}),this.$nextTick(()=>{this.$myLyric&&(this.$myLyric.updateSlides(),this.$myLyric.updateSize(),this.$myLyric.slideTo(0,0))})}));let s=t=>{this.clickEle(t,t=>{t.stopPropagation(),this.playState&&(1===this.playState?this.play():this.pause())})};s(this.$refs.play0),s(this.$refs.play1),s(this.$refs.play2),this.clickEle(this.$refs.pre,()=>{let t=JSON.parse(window.localStorage.getItem("songList")),e=+window.localStorage.getItem("currentIndex");e=e-1<0?t.length-1:e-1,this.localIndex=e,window.localStorage.setItem("currentIndex",e);let s=t[e]._id;this.$store.dispatch("changeCurrentA",s)}),this.clickEle(this.$refs.next,()=>{let t=JSON.parse(window.localStorage.getItem("songList")),e=+window.localStorage.getItem("currentIndex");e=e+1>t.length-1?0:e+1,this.localIndex=e,window.localStorage.setItem("currentIndex",e);let s=t[e]._id;this.$store.dispatch("changeCurrentA",s)});let r=t=>{this.clickEle(t,t=>{t.stopPropagation(),this.localSongList=JSON.parse(window.localStorage.getItem("songList")),this.localIndex=+window.localStorage.getItem("currentIndex"),this.playState&&(this.$refs.listBox.style.display="block",setTimeout(()=>{this.$refs.listBox.style.opacity=1,this.$refs.localList.style.bottom=0},20))})};r(this.$refs.list),r(this.$refs.list0),this.clickEle(this.$refs.listBox,t=>{let e=t.target.className;(e.includes("listBox")||"listClose"==e)&&(this.$refs.listBox.style.opacity=0,this.$refs.localList.style.bottom="-100%",setTimeout(()=>{this.$refs.listBox.style.display="none"},500))}),this.clickEle(this.$refs.ulist,t=>{let[e,s]=[null,null];"li"==t.target.nodeName.toLowerCase()?(e=t.target.id,s=t.target.dataset.index):"span"==t.target.nodeName.toLowerCase()&&(e=t.target.parentNode.id,s=t.target.parentNode.dataset.index),e&&(this.$store.dispatch("changeCurrentA",e),this.localIndex=s,window.localStorage.setItem("currentIndex",s))}),this.clickEle(this.$refs.box,()=>{this.playState&&(this.enterOrLeave=!0)}),this.clickEle(this.$refs.back,()=>{this.enterOrLeave=!1}),this.songBoxInit(),this.lyricInit(),this.$refs.myAudio.addEventListener("canplay",()=>{this.duration=this.$refs.myAudio.duration,this.canPlay=!0})},computed:{...Object(l["b"])(["current","list"]),currentSongInfo(){return this.list.find(t=>t.songId===this.current)},currentLyric(){return this.currentSongInfo?this.currentSongInfo.lyric:[]}},watch:{$route(t){"/"===t.path?this.moveBoxTo(0):this.moveBoxTo(1)},current(){this.rowIndex=0,this.canPlay=!1,this.$nextTick(()=>{let t=setInterval(()=>{this.canPlay&&(this.play(!0),clearInterval(t))});this.$myLyric&&(this.$myLyric.updateSlides(),this.$myLyric.updateSize(),this.$myLyric.slideTo(0,0))})}},components:{Scroll:p}},f=m,v=(s("d3b9"),Object(u["a"])(f,i,a,!1,null,"7090059d",null)),y=v.exports,I=s("8c4f"),w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("div",{staticClass:"swiper-container"},[s("div",{staticClass:"swiper-wrapper"},[s("div",{staticClass:"swiper-slide musicPage"},[t._m(0),s("Scroll",[s("Refresh",{attrs:{loading:t.loading,changeLoading:t.changeLoading}},[s("ul",{staticClass:"classList"},t._l(t.data,(function(e,r){return s("li",{key:r,on:{click:function(s){return t.toSongList(e.uploader)}}},[s("img",{attrs:{src:e.img}}),s("span",[t._v(t._s(e.uploader))])])})),0)])],1)],1),s("div",{staticClass:"swiper-slide"},[t._m(1),s("Scroll",{attrs:{contentStyle:t.contentStyleMy}},[s("div",{staticClass:"userInfo"},[t._v(t._s(t.isLogin?t.userInfo.username:"未登录"))]),s("div",{staticClass:"wraper"},[s("label",{staticClass:"label",attrs:{for:"songname"}},[t._v("歌曲名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.songname,expression:"songname"}],class:t.song?"":"no",attrs:{type:"text",id:"songname",placeholder:"请填写歌曲名"},domProps:{value:t.songname},on:{input:[function(e){e.target.composing||(t.songname=e.target.value)},function(e){return t.handleinput("song")}]}})]),s("div",{staticClass:"wraper"},[s("label",{staticClass:"label",attrs:{for:"authorname"}},[t._v("作者名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.authorname,expression:"authorname"}],class:t.author?"":"no",attrs:{type:"text",id:"authorname",placeholder:"请填写歌曲作者名"},domProps:{value:t.authorname},on:{input:[function(e){e.target.composing||(t.authorname=e.target.value)},function(e){return t.handleinput("author")}]}})]),s("input",{attrs:{type:"file",name:"audio",id:"audio"},on:{change:function(e){return t.handleFile("audio")}}}),s("input",{attrs:{type:"file",name:"lyric",id:"lyric"},on:{change:function(e){return t.handleFile("lyric")}}}),s("input",{attrs:{type:"file",name:"img",id:"img"},on:{change:function(e){return t.handleImg("img")}}}),s("input",{attrs:{type:"file",name:"feng",id:"feng"},on:{change:function(e){return t.handleImg("feng")}}}),s("label",{class:"uploadfile "+(t.audio?"":"noUpload"),attrs:{for:"audio"}},[t._v("上传音频")]),s("label",{class:"uploadfile "+(t.lyric?"":"noUpload"),attrs:{for:"lyric"}},[t._v("上传歌词")]),s("div",{staticClass:"imgwrap"},[s("label",{class:"uploadimg "+(t.img?"":"noUpload"),attrs:{for:"img"}},[t.imgSrc?s("img",{attrs:{src:t.imgSrc}}):s("span",[t._v("上传歌曲封面")])]),s("label",{class:"uploadimg "+(t.feng?"":"noUpload"),attrs:{for:"feng"}},[t.fengSrc?s("img",{attrs:{src:t.fengSrc}}):t.userInfo&&t.userInfo.img?s("img",{attrs:{src:t.userInfo.img}}):s("span",[t._v("上传歌单封面")])])]),s("button",{ref:"upload"},[t._v("点击上传")]),s("button",{ref:"loginAgain",staticClass:"loginAgain"},[t._v("重新登录")])])],1)])]),s("div",{staticClass:"tar"},[s("dl",{ref:"music"},[s("dt",{class:0==t.realIndex?"tar_icon music_select":"tar_icon music"}),s("dd",{class:0==t.realIndex?"active":""},[t._v("音乐馆")])]),s("dl",{ref:"my"},[s("dt",{class:1==t.realIndex?"tar_icon mine_select":"tar_icon mine"}),s("dd",{class:1==t.realIndex?"active":""},[t._v("我的")])])])])},C=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("span",{staticClass:"headFont"},[t._v("音乐馆")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",[s("span",{staticClass:"headFont"},[t._v("我的")])])}],S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrap"},[s("div",{staticClass:"loading"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.loadingOrText,expression:"loadingOrText"}],class:t.canRefesh?"loadingWrap loadingWrap0":"loadingWrap"},[s("div",{staticClass:"short"}),s("div",{staticClass:"middle"}),s("div"),s("div",{staticClass:"middle"}),s("div",{staticClass:"short"})]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loadingOrText,expression:"!loadingOrText"}],staticClass:"textend"},[t._v("加载完成")])]),t._t("default")],2)},x=[],E={name:"Loading",props:["loading","changeLoading"],data(){return{timer:[],auto:!0,translateY:0,wrap:null,loadingWrap:null,canRefesh:!1,loadingOrText:!0,load:!0}},methods:{getStyle(t,e){return t.currentStyle?parseFloat(t.currentStyle[e]):parseFloat(getComputedStyle(t,null)[e])},animation(t,e){clearInterval(t.timer);let s,r,i=1;t.timer=setInterval(()=>{s=this.getStyle(t,"height"),r=s+i*e,(r<6||r>26)&&(e=-e,r=s+i*e),t.style.height=r+"px"},1e3/60),this.timer.push(t.timer)},startani(){this.remove();let t=document.querySelectorAll(".loadingWrap div");for(let e=0;e<t.length;e++)e<=2?this.animation(t[e],-1):this.animation(t[e],1)},endani(){this.canRefesh=!1,this.loadingOrText=!1;let t=document.querySelectorAll(".loadingWrap div");for(let e=0;e<this.timer.length;e++)clearInterval(this.timer[e]);for(let e=0;e<t.length;e++)"short"==t[e].className?t[e].style.height="17px":"middle"==t[e].className?t[e].style.height="21px":t[e].style.height="26px";setTimeout(()=>{this.back(0,()=>{this.load=!1})},1e3)},remove(){let t=document.querySelector(".loadingWrap").children;for(let e=0;e<t.length;e++)t[e].children.length&&t[e].children[0].remove()},back(t,e){let s,{wrap:r}=this;clearInterval(r.timerBack),r.timerBack=setInterval(()=>{s=this.translateY>1?this.translateY/10:.1,this.translateY-=s,this.translateY<=t&&(this.translateY=t,clearInterval(r.timerBack),this.loadingOrText=!0,e&&e()),r.style.transform="translateY("+this.translateY+"rem)"},1e3/60)},autoRefresh(){let{wrap:t}=this;clearInterval(t.timerdown),t.timerdown=setInterval(()=>{this.translateY+=.1,this.translateY>=1&&(this.translateY=1,clearInterval(t.timerdown),this.startani()),t.style.transform="translateY("+this.translateY+"rem)"},1e3/60)},addChlid(t,e){if(t.children.length)t.children[0].style.height=e+"rem";else{let s=document.createElement("div");s.style.width="100%",s.style.height=e+"rem",s.style.backgroundColor="#111310",s.style.borderRadius="2px",t.appendChild(s)}},pullRefresh(){let t,e,s,r=parseFloat(document.documentElement.style.fontSize),[i,a]=[0,0];this.wrap.addEventListener("touchstart",r=>{r=r||window.event,i=r.changedTouches[0].clientX,a=r.changedTouches[0].clientY,t=!0,e=!1,s=this.translateY}),this.wrap.addEventListener("touchmove",s=>{s=s||window.event;let n=this.wrap.getBoundingClientRect().top,l=s.changedTouches[0].clientY;if(n<0){let t=s.changedTouches[0].clientX;return i=t,void(a=l)}if(e||this.loading||this.load)return;let o=l-a;if(t){t=!1;let r=s.changedTouches[0].clientX,a=r-i;if(Math.abs(a)>=o)return void(e=!0)}this.translateY+=o/r/4,a=l,this.translateY<=0&&(this.translateY=0,e=!0),this.wrap.style.transform="translateY("+this.translateY+"rem)"}),this.wrap.addEventListener("touchend",t=>{t=t||window.event,this.translateY>1?this.back(1,()=>{this.changeLoading(),this.load=!0}):this.translateY<1&&this.translateY>0&&(this.back(0),this.remove(),this.canRefesh=!1)})}},mounted(){this.wrap=document.querySelector(".wrap");let t=setInterval(()=>{this.loading||(clearInterval(t),setTimeout(()=>{let t=window.innerHeight,e=this.wrap.offsetHeight;e<t&&(this.wrap.style.height=t+"px")},500))});this.autoRefresh(),this.pullRefresh()},watch:{loading(t,e){t?this.startani():this.endani()},translateY(t,e){if(t-e>0&&t>=.5){let e=2.04*(t-.5)/.5,s=document.querySelector(".loadingWrap");switch(!0){case e<=.34:this.addChlid(s.children[0],e);break;case e<=.76:this.addChlid(s.children[1],e-.34);break;case e<=1.28:this.addChlid(s.children[2],e-.76);break;case e<=1.7:this.addChlid(s.children[3],e-1.28);break;case e<2.04:this.addChlid(s.children[4],e-1.7);break;case e>=2.04:this.canRefesh=!0;break}}}}},k=E,L=(s("dffe"),Object(u["a"])(k,S,x,!1,null,"15daa6ac",null)),b=L.exports,T={name:"Home",data(){return{realIndex:0,headText:"音乐馆",loading:!0,data:[],translateY:0,isLogin:!1,userInfo:{},songname:"",authorname:"",song:!0,author:!0,audio:!0,lyric:!0,img:!0,feng:!0,fengSrc:"",imgSrc:"",fileList:{},contentStyle:{paddingBottom:"2rem"},contentStyleMy:{paddingTop:"1rem",paddingBottom:"2rem"}}},methods:{toSongList(t){this.$router.push({path:"/songList/"+t})},async initData(){let t=(new Date).getTime(),e=await this.$api.songClass(),s=(new Date).getTime();if(s-t<500){let t=setTimeout(()=>{clearTimeout(t),this.loading=!1},500)}else this.loading=!1;this.data=e.data},select(t){t!=this.realIndex&&this.$mySwiper.slideTo(t,0)},changeLoading(){this.loading=!0,this.initData()},initPage(){let t=this;this.$mySwiper=new n["a"](".swiper-container",{on:{slideChange(){t.realIndex=this.realIndex}}}),this.clickEle(this.$refs.music,()=>{this.select(0)}),this.clickEle(this.$refs.my,()=>{this.select(1)})},async getUserInfo(){let t=localStorage.getItem("token");if(!t)return;let e=await this.$api.getUserInfo({token:t});e.data.err?this.isLogin=!1:(this.isLogin=!0,this.userInfo=e.data)},handleinput(t){this[t]||(this[t]=!0)},handleFile(t){let e=document.querySelector("label[for="+t+"]"),s=document.getElementById(t);s.files[0]&&(e.innerText=s.files[0].name,this.fileList[t]=s.files[0],this[t]=!0)},handleImg(t){document.querySelector("label[for="+t+"]");let e=document.getElementById(t);if(!e.files[0])return;this.fileList[t]=e.files[0],this[t]=!0;let s=window.URL.createObjectURL(e.files[0]);"img"==t?this.imgSrc=s:this.fengSrc=s},rules(){let t=!0,{songname:e,authorname:s}=this,{audio:r,lyric:i,img:a,feng:n}=this.fileList;return e||(this.song=!1,t=!1),s||(this.author=!1,t=!1),r||(this.audio=!1,t=!1),i||(this.lyric=!1,t=!1),a||(this.img=!1,t=!1),this.userInfo.img||n||(this.feng=!1,t=!1),t}},created(){this.initData()},mounted(){this.initPage(),this.getUserInfo(),this.clickEle(this.$refs.upload,t=>{this.isLogin||this.$router.push("/login");let e=this.rules();if(e){let{songname:t,authorname:e}=this,s=new FormData;s.append("songname",t),s.append("authorname",e),s.append("uploader",this.userInfo.username);for(let r in this.fileList)s.append(r,this.fileList[r]);this.$api.upload(s).then(t=>{if(t.data.success){this.songname="",this.authorname="",this.imgSrc="";let t=document.querySelector("label[for=audio]");t.innerText="上传音频";let e=document.querySelector("label[for=lyric]");e.innerText="上传歌词",this.fileList={}}})}}),this.clickEle(this.$refs.loginAgain,()=>{this.$router.push("/login")})},components:{Refresh:b,Scroll:p}},A=T,Y=(s("b752"),Object(u["a"])(A,w,C,!1,null,"00809ef2",null)),B=Y.exports,_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("header",[r("img",{ref:"back",attrs:{src:s("309f")}}),r("div",[t._v(t._s(this.$route.params.uploader+"的歌单"))])]),r("Scroll",[t.data?r("ul",{staticClass:"songList"},t._l(t.data,(function(e,s){return r("li",{key:e._id,ref:"eachSong",refInFor:!0,class:e._id===t.$store.state.current?"songSing":"",attrs:{"data-index":s,id:e._id}},[r("div",{staticClass:"index"},[t._v(t._s(s+1))]),r("div",{staticClass:"NA"},[r("h3",[t._v(t._s(e.name))]),r("div",[t._v(t._s(e.author))])])])})),0):t._e()])],1)},Q=[],O={data(){return{data:null}},methods:{async initData(){let t=this.$route.params.uploader,e=await this.$api.songList({uploader:t});this.data=e.data,this.data.length&&this.$nextTick(()=>{this.$refs.eachSong.forEach(t=>{this.spread(t,t=>{let e=JSON.parse(window.localStorage.getItem("songList"));this.$route.params.uploader==window.localStorage.getItem("songListName")&&this.data.length==e.length||(window.localStorage.setItem("songListName",this.$route.params.uploader),window.localStorage.setItem("songList",JSON.stringify(this.data))),window.localStorage.setItem("currentIndex",t.currentTarget.dataset.index);let s=t.currentTarget.id;this.$store.dispatch("changeCurrentA",s)})})})}},mounted(){this.clickEle(this.$refs.back,()=>{this.$router.back()}),this.initData()},components:{Scroll:p}},$=O,N=(s("c5cc"),Object(u["a"])($,_,Q,!1,null,"5513a2de",null)),R=N.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"wrap"},[s("label",{attrs:{for:"username"}},[t._v("用户名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],class:t.user?"":"no",attrs:{type:"text",id:"username",placeholder:"请填写用户名"},domProps:{value:t.username},on:{input:[function(e){e.target.composing||(t.username=e.target.value)},function(e){return t.handleinput("user")}]}})]),s("div",{staticClass:"wrap"},[s("label",{attrs:{for:"password"}},[t._v("密码")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],class:t.pass?"":"no",attrs:{type:"password",id:"password",placeholder:"请填密码"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},function(e){return t.handleinput("pass")}]}})]),s("button",{staticClass:"login",on:{click:t.login}},[t._v("登录")]),s("button",{staticClass:"nologin",on:{click:t.nologin}},[t._v("暂不登录")])])},H=[],D=s("6821"),F=s.n(D),j={data(){return{username:"",password:"",user:!0,pass:!0}},methods:{async login(){let{username:t,password:e}=this;if(t||(this.user=!1),e||(this.pass=!1),t&&e){e=F()(e);let s=await this.$api.login({username:t,password:e});s=s.data,s.token&&(localStorage.setItem("token",s.token),this.$router.back(-1))}},nologin(){this.$router.back(-1)},handleinput(t){this[t]||(this[t]=!0)}}},M=j,P=(s("6324"),Object(u["a"])(M,J,H,!1,null,"35040ec4",null)),q=P.exports;r["a"].use(I["a"]);const U=[{path:"/",name:"Home",component:B},{path:"/songList/:uploader",name:"songList",component:R},{path:"/login",name:"login",component:q}],G=new I["a"]({routes:U});var W=G,Z=s("4328"),V=s.n(Z),K=s("bc3a"),z=s.n(K);let X="http://suzhengyao888.com:3000",tt={songClass(){return z()({method:"get",url:X+"/songClass"})},songList(t){return z()({method:"post",url:X+"/songList",data:V.a.stringify(t)})},songInfo(t){return z()({method:"post",url:X+"/songInfo",data:V.a.stringify(t)})},login(t){return z()({method:"post",url:X+"/users/login",data:V.a.stringify(t)})},getUserInfo(t){return z()({method:"post",url:X+"/users/getUserInfo",data:V.a.stringify(t)})},upload(t){return z()({method:"post",url:X+"/users/upload",data:t,processData:!1,contentType:!1})}};var et=tt;function st(t,e,s){return 60*t*1e3+1e3*e+10*s}function rt(t){let e=[];return t.replace(/\[\d+:\d+\.\d+\].+/g,t=>{let s={sentence:{},words:[]},r=/\[(\d+):(\d+)\.(\d+)\]$/,i=r.exec(t),a=st(i[1],i[2],i[3]),n=!0,l="",o=null,c="";t.replace(/\[(\d+):(\d+)\.(\d+)\]([^\[]*)/g,(t,...e)=>{let[r,i,d,h]=e,u=st(r,i,d);if(n)s.sentence.start=u,s.sentence.end=a,n=!1;else{let t=u-o,e={};if(c=c.replace(/ /g," "),e.content=c,e.start=o,e.continued=t,s.words.push(e),!h)return}[o,c]=[u,h],l+=h}),s.sentence.sentence=l,e.push(s)}),e}r["a"].use(l["a"]);let it=JSON.parse(window.localStorage.getItem("songList")),at=window.localStorage.getItem("currentIndex"),nt=it?it[at]._id:"";var lt=new l["a"].Store({state:{current:nt,list:[]},mutations:{initListM(t,e){let{data:s}=e;s[0].lyric=rt(s[0].lyric),t.list=s},changeCurrentM(t,e){let{_id:s,data:r}=e;s!==t.current&&(t.current=s,r&&(r=r[0],r.lyric=rt(r.lyric),t.list=[...t.list,r]))}},actions:{async changeCurrentA({state:t,commit:e},s){let r=t.list.find(t=>t.songId===s);if(r)e("changeCurrentM",{_id:s});else{let{data:t}=await et.songInfo({_id:s});e("changeCurrentM",{_id:s,data:t})}}},modules:{}});s("a7a3");r["a"].prototype.$api=et,r["a"].config.productionTip=!1,r["a"].prototype.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:getComputedStyle(t,null)[e]},r["a"].prototype.spread=function(t,e){t.flag=!1,t.addEventListener("touchstart",e=>{t.flag=!0,e=e||window.event;let s=e.currentTarget,r=setTimeout(()=>{if(clearTimeout(r),t.flag){let t=document.createElement("div");t.className="spread",s.appendChild(t);let[e,r]=[200,.6],i=window.innerWidth,a=setInterval(()=>{e+=20,e>i+20&&(clearInterval(a),t.remove()),r-=.02,t.style.width=e+"px",t.style.height=e+"px",t.style.transform="translateX("+-e/2+"px) translateY("+-e/2+"px)",t.style.opacity=r},1e3/60)}},150)}),t.addEventListener("touchmove",()=>{t.flag=!1}),t.addEventListener("touchend",s=>{s=s||window.event,t.flag&&e&&e(s)})},r["a"].prototype.clickEle=function(t,e){t.flag=!1,t.addEventListener("touchstart",()=>{t.flag=!0}),t.addEventListener("touchmove",()=>{t.flag=!1}),t.addEventListener("touchend",s=>{s=s||window.event,t.flag&&e&&e(s)})},new r["a"]({router:W,store:lt,render:function(t){return t(y)}}).$mount("#app")},6324:function(t,e,s){"use strict";var r=s("40d7"),i=s.n(r);i.a},9817:function(t,e,s){},b752:function(t,e,s){"use strict";var r=s("3f69"),i=s.n(r);i.a},c5cc:function(t,e,s){"use strict";var r=s("9817"),i=s.n(r);i.a},d3b9:function(t,e,s){"use strict";var r=s("0786"),i=s.n(r);i.a},dffe:function(t,e,s){"use strict";var r=s("ed39"),i=s.n(r);i.a},ed39:function(t,e,s){}});
//# sourceMappingURL=app.5464cd18.js.map